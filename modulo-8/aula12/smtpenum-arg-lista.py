#!/usr/bin/python

import  socket, sys, re 

if len(sys.argv) != 4:
	print 'Use: python sys.argv[0] IP porta lista'
	sys.exit(0)
else:
	#Carrega lista
	f = open(sys.argv[3])
	for usuario in f.readlines():
		#Cria o socket
		s = socket.socket(AF_INET, socket.SOCKS_STREAM)
	
		#Testa conexao com o alvo
		if s.connect_ex(sys.argv[1], sys.argv[2]) == 0:
	
			#Exibe o banner
			#banner = s.recv(1024)
			#print banner
			
			#Pega resposta da conex√£o
			resp = s.recv(1024)
		
			#envia um usuario para testar se este existe		
			s.send('VRFY' + usuario + '\r\n')
			resp = s.recv(1024)
			#print r
			if re.search('252', resp):
				print 'Usuario encontrado' + resp.strip('252 2.0.0.0')
			#Fecha o Socket
			s.close()	
	
