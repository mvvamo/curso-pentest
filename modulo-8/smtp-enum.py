#!/usr/bin/python

import  socket, sys, re 

#sys.argv(1) = IP
#sys.argv(2) = porta
#sys.argv(3) = Lista

if len(sys.argv) != 4:
	print 'Use: python sys.argv[0] IP porta lista'
	sys.exit(0)
else:
	#Carrega lista
	f = open(sys.argv[3])

	for linha in f.readlines():
		#Cria o socket
		s = socket.socket(AF_INET, socket.SOCKS_STREAM)
		
		#Testa conexao com o alvo
		if s.connect_ex(sys.argv[1], sys.argv[2]) == 0:
		
		#Exibe o banner
			banner = s.recv(1024)
			
			print banner
			
		#envia um usuario para testar se este existe		
			s.send('VRFY' + sys.argv[3] + '\r\n')
			r = s.recv(1024)
			
			print r
		
		#Fecha o Socket
			s.close()	
	
