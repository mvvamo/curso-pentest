#!/bin/bash

#Definindo variaveis
ALVO=$1
LISTA=$2 

HELP() {
	echo -e "\033[0035m############################################# \033[m"
        echo -e "\033[0032m####### Desec Discobery ###############\nDesec Security Treinamento- Marcus Oliveira \033[m"
        echo -e "\033[0032m./$0 www.alvo.com.br lista.txt \033[m"
        echo -e "\033[0035m############################################# \033[m"
}

DISCOVERY_DIR() {

	for DIRETORIO in $(cat $LISTA)
	do
		RESPOSTA=$(curl -s -o /dev/null -w '%{http_code}' $ALVO/$DIRETORIO/)
		if [ $RESPOSTA == '200' ]
		then
			echo -e "\033[0035m############################################# \033[m"
			echo "Diretorio encontrado: $DIRETORIO"
		fi
	done

}

DISCOVERY_FILE() {

        for ARQUIVO in $(cat $LISTA)
        do
                RESPOSTA=$(curl -s -o /dev/null -w '%{http_code}' $ALVO/$ARQUIVO)
                if [ $RESPOSTA == '200' ]
                then
                        echo -e "\033[1;34m############################################# \033[m"
                        echo "Arquivo encontrado: $ARQUIVO"
                fi
        done

} 


if [ $# -ne 2 ]
then
        HELP

else
	
	DISCOVERY_DIR $ALVO
	DISCOVERY_FILE $ALVO
fi
