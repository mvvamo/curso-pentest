O ttl pode determinar qual é o SO.

No nmap você pode usar o -O
nmap -O alvo

Arquivo usado pelo nmap para dectar o SO:
/usr/share/nmap/nmap-os-db

Alterando TTL no linux:
/proc/sys/net/ipv4/ip_default_ttl

Outra ferramenta é o xprobe2:
xprobe2 -p 'protocolo:porta:estado' alvo
ex:
xprobe2 -p 'tcp|udp:80:open|closed' alvo



