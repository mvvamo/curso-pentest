#!/usr/bin/python

import socket, sys

def banner():
	print '[++]	Cliente TCP em Python		 [++]'
	print '[++] Desec Security - Marcus Oliveira 	 [++]'
	print '#' * 45

def resolvname(host):
	host = socket.gethostbyname(host)
	return host

def meusocket(host,porta):
#	host = socket.gethostbyname(host)
	mysocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	if mysocket.connect_ex((host,int(porta))) == 0:
		print '[++] Chave encontrada :'
		print 'Serial Number %s' % str(mysocket.recv(4096))
		mysocket.close()
	else:
		print 'Erro ao conectar'

if len(sys.argv) == 3:
	banner()
	hostname = resolvname(sys.argv[1])
	print '[++] Conectado ao servidor %s de hostname ! [++]' % hostname,sys.argv[1]
	print '#' * 45
	meusocket(hostname,sys.argv[2])

else:
	banner()
        print 'Insira hostname ou IP e porta'
	print 'Exemplo: python %s IP/HOSTNAME porta' % sys.argv[0]
